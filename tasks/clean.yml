#file: tasks/clean.yml
---
# Clean EFM
- name: stop efm 
  systemd:
    name: "edb-efm-{{ EFM_VERSION }}"
    state: stopped
- name: clean efm configs
  file:
    path: "{{ item }}"
    state: absent
  with_items:
  - "/etc/edb/efm-{{ EFM_VERSION }}/efm.nodes"
  - "/etc/edb/efm-{{ EFM_VERSION }}/efm.properties"
  - "/var/log/efm-{{ EFM_VERSION }}/efm.log"
  - "/var/log/efm-{{ EFM_VERSION }}/startup-efm.log"

# Clean Posgresql
- name: stop postgres
  systemd:
    name: "postgresql-{{ PGVER }}"
    state: stopped
- name: clean pgdata
  file:
    path: "{{ PGDATA }}"
    state: absent

# Clean repo
- name: clean repo data
  file:
    path: "/opt/repos/repodata"
    state: absent
  tags: ['never', 'repo_clean']
